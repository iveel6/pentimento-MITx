<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
        <script src="generalfunctions.js"></script>
        <script src="listeners.js"></script>
        <script src="renderer.js"></script>
        <script src="archive/asdf.js"></script>
        <script src="preprocessor.js"></script>
        <style>
            .canvas {
                width: 640px;
                height: 480px;
                overflow: hidden;
            }
            iframe {
                position: relative;
                top: -480px;
                -webkit-transform: scale(0.5);
            }
        </style>
    </head>
    <body>
        <input type="text"><br>
        <div class="canvas">
            <canvas width=640 height=480></canvas>
<!--            <iframe width=800 height=600 frameborder=0 scrolling=no src="http://web.mit.edu/6.mitx/www/6.00%20Line-Fitter/line-fitter.html"></iframe>-->
        </div>
        <div class='thumbs'></div>
    </body>
    <script>
        $(document).ready(function() {
            var initialLength = 0;
            for(var i=0; i<lecture.visuals.length; i++) {
                if(lecture.visuals[i].type === "stroke")
                    initialLength += lecture.visuals[i].vertices.length;
            }
            
            preprocess(lecture, 1);
            
            var finalLength = 0;
            for(var i=0; i<lecture.visuals.length; i++) {
                if(lecture.visuals[i].type === "stroke")
                    finalLength += lecture.visuals[i].vertices.length;
            }
            
            console.log(initialLength, finalLength);
            
            var canvas = $('.canvas');
            var renderer = PentimentoRenderer(canvas, lecture);
            var listener = PentimentoListener(canvas, lecture, renderer.fire);
            
            for(var i=0; i<5; i++) {
                $('.thumbs').append(renderer.getThumbCanvas(100, 75, (i+1)/5*lecture.durationInSeconds, i/5*lecture.durationInSeconds));
            }
            $('.thumbs').find('canvas').each(function() {
                $(this).css({
                    float: 'left',
                    margin: '10px',
                    border: '1px solid gray'
                });
            });
            
            $('input').attr('placeholder','Max Time: '+lecture.durationInSeconds);
            $('input').on('keyup',function(e){
//                if(e.which === 13) {
                    renderer.renderFrame(parseFloat($(this).val()));
//                }
            });
        });
    </script>
</html>